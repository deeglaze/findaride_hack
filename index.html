<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Ride++</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.7/dist/leaflet.css">


    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet">


    <style>


      .header_site { background-color: darkblue; }
      font { color: white; margin: auto 160px auto 160px; }
      .page-header,
      .page-header h1 {margin-top:0;}



      #map { 
        width: auto;
        height: 910px;
  
      }



      .leaflet-tile-pane {
        opacity: 1;
        //-webkit-filter: grayscale(100%);
        //filter: grayscale(100%);
      }




      #nav-sear{
          display:block;
          text-align:center;
      }




    </style>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body onload="initialize()">




    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-3 sidebar">

          <div class="page-header" style="text-align: center;"">
            <h1>Find A Ride++</h1>
          </div>

          <div class="panel panel-default">
            <div class="panel-body">
              
              <div class="input-group">
                <span class="input-group-addon" id="basic-addon1"> <span class="glyphicon glyphicon-flag" style="color: green;" aria-hidden="true"></span> </span>
                <input type="text" class="form-control" name="origin" placeholder="Origin" aria-describedby="basic-addon1">
                <span class="input-group-btn">
                  <button class="btn btn-default" type="button" onclick="getLocation('o')"><span class="glyphicon glyphicon-screenshot"  aria-hidden="true"></span></button>
                </span>


              </div>

              <div class="input-group" style="color: red; margin-top: 5px;">
                <span class="input-group-addon" id="basic-addon1"> <span class="glyphicon glyphicon-flag" style="color: red;" aria-hidden="true"></span> </span>
                <input type="text" class="form-control" name="destination" placeholder="Destination" aria-describedby="basic-addon1">
                <span class="input-group-btn">
                  <button class="btn btn-default" type="button" onclick="getLocation('d')"><span class="glyphicon glyphicon-screenshot"  aria-hidden="true"></span></button>
                </span>
              </div>



            </div>
          </div>
  

          <div class="panel panel-default">
            <div class="panel-body">

              <label> Type of Trip </label>              
              <div class="btn-group" data-toggle="buttons">
                <label class="btn btn-primary active">
                  <input type="radio" name="options" id="option1" autocomplete="off" checked> Medical Visit
                </label>
                <label class="btn btn-primary">
                  <input type="radio" name="options" id="option2" autocomplete="off"> Grocery Store
                </label>
                <label class="btn btn-primary">
                  <input type="radio" name="options" id="option3" autocomplete="off"> Others
                </label>
              </div>
            </div>



          </div>

<button type="button" id="go" onclick="showAddress()" data-loading-text="Loading..." class="btn btn-primary" autocomplete="off" style="text-align: center;">
  Go!
</button>




        </div>
        


        <div class="col-sm-8 col-md-9 main">

          <div id="map"></div>          


        </div>
      </div>
    </div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script
      src="https://code.jquery.com/jquery-2.2.4.min.js"
      integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
      crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- google map API -->
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 47.6062, lng: -122.3321},
          zoom: 15
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDjB5G0Fod2mUs0u9a-B4cF3xyqQa5uAs&sensor=false&libraries=drawing&callback=initMap"></script>
    <script type="text/javascript" src="script/geoxml3.js"></script>
    <script type="text/javascript" src="script/v3_epoly.js"></script>

    <script src="js/geoMap.js"></script>


    <script type="text/javascript">
        $(document).ready(function(){
            $('#seartxt').keypress(function(e){
                if(e.keyCode==13){
                    $('#searbtn').click();
                    return false; // Avoid Refresh page after run function. This line kill everything
                }
            });
        })


        var dartPickupAreas = null;
        var map = null;
        var geocoder = null;
        var toggleState = 1;
        var infowindow = null;
        var marker = null;

        function initialize() {
            geocoder = new google.maps.Geocoder();
            infowindow = new google.maps.InfoWindow({size: new google.maps.Size(150,50) });
            // create the map
            var myOptions = {
                center: new google.maps.LatLng(47.6062, -122.3321),
                mapTypeControl: true,
                mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
                navigationControl: true,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }

            map = new google.maps.Map(document.getElementById("map"), myOptions);
            dartPickupAreas = new geoXML3.parser({map: map, singleInfoWindow: true, infoWindow: infowindow});

            dartPickupAreas.parse("data/dart_area.kml");
        }

        function showAddress() {
            address = $('input[name=origin]').val();
            var contentString = address+"<br>Outside DART Service Area";

            geocoder.geocode({'address': address}, function(results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    var point = results[0].geometry.location;
                    map.setCenter(point);
                    if (marker && marker.setMap) marker.setMap(null);
                    marker = new google.maps.Marker({map: map, position: point});
                    for (var i=0; i<dartPickupAreas.docs[0].gpolygons.length; i++) {
                        if (dartPickupAreas.docs[0].gpolygons[i].Contains(point)) {
                            contentString = address+"<br>"+dartPickupAreas.docs[0].placemarks[i].name;
                            break;
                        }
                    }
                    google.maps.event.addListener(marker, 'click', function() {
                        infowindow.setContent(contentString);
                        infowindow.open(map,marker);
                    });
                    google.maps.event.trigger(marker,"click");
                } else {
                    alert("Geocode was not successful for the following reason: " + status);
                }
            });
        }
    </script>






    <script>


      function getLocation(box) {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else { 
            //x.innerHTML = "Geolocation is not supported by this browser.";
        }

        $('input[name=origin]').val('Current Location');
      }

      function showPosition(position) {

      //var marker = L.marker([position.coords.latitude,position.coords.longitude]).addTo(map);

      var myLatLng = {lat: position.coords.latitude, lng: position.coords.longitude};
      var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: 'Start'
      });



      }

    //navigator.geolocation.getCurrentPosition(showPosition);

    </script>

 

  </body>
</html>
